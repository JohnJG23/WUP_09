---
title: "Weight of Fish"
author: "John Garza"
date: "`r Sys.Date()`"  
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5

 
    
---


```{r include=FALSE,echo=FALSE}
require(tigerstats)
require(tidyverse)
```

# Predicting Fish Weight

```{r}
Fish <-read.csv(file="Fish.csv",header=TRUE)
```

## Perch

```{r}
Perch <- filter(Fish, Species=="Perch")
Perch <- select(Perch, -(Species))
```


### Best Models

```{r}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = Perch,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="topright",main="Adjusted R^2")
```

### Best Two regressor model

```{r}
best.model <- lm(Weight~Height+Width,data=Perch)
summary(best.model)
``` 

The models above are a representation of the best model and the best Two regressor mode. That is we see that height and width at the top of the graph. Where the adjusted r square value is 0.940.       

```{r}
best_Perch_Model <- lm(Weight~Height+Width,data=Perch)
five_element_perch_model <- lm(Weight~.,data=Perch)
anova(best_Perch_Model, five_element_perch_model)
```

This analysis of Variance represents how the Two element model is most likely to be significant. That is why there is not much difference when comparing its values for the RSS value against a five element model. Where model 1 which is going from height and width is 384478 and model 2 which is going from Length1, Length3, Length3, Hight, and Width is 379369.       

## Pike
```{r}
Pike <- filter(Fish, Species=="Pike")
Pike <- select(Pike, -(Species))
```

### Best Models
```{r}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = Pike,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="topleft",main="Adjusted R^2")
```

These response's from the r command displays the best model of the data used for predicting pike fish weight. The subset size is the x axis and the statistic adjusted R-squared value is the y axis. The legend communicates what the highest plot "L1-L2-L3-H-W" stands for. The plot is significant because it is the best model for the pike prediction. That is why it appears above all of the others. Where the adjusted r square value is 0.975.     

### Best Two regressor model
```{r}
Pike_best.model <- lm(Weight~.,data=Pike)
summary(Pike_best.model)
Pike_best_2_R_Model <-lm(Weight~Length1+Length3, data=Pike)
``` 

 created several models through the automated process. compare the best 2 element model to the one that has everyhting iin it.  

```{r}
Pike_best.model <- lm(Weight~.,data=Pike)
Pike_best_2_R_Model <-lm(Weight~Length1+Length3, data=Pike)
anova(Pike_best.model, Pike_best_2_R_Model)
```

when we use anavo it comes up with a p value that is .0 and is comparing both models and since the p value isj lower than . 05 we conclude that it is significant below the .05 level. 


## Roach

```{r}
Roach <- filter(Fish, Species=="Roach")
Roach <- select(Roach, -(Species))
```

### Best Models
```{r}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = Roach,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="bottomleft",main="Adjusted R^2")
```

above 1 is the best 1 element and above 2 is the best 2 element, above the three is the best 3 element model and so on.. acording to the graph the best model is the 2 element model since its above the rest models. this is like the perch since the best element model is a 2 element model next   


### Best Two regressor model

## Final Summary Statements